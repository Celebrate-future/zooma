#  Add A Prioiri configs to Python 3 alpine base

FROM python:3.7.1-alpine AS python-preconf4apriori

#  On the command line, we used to have to set any string value for DEV, e.g.
#  "yes" if building in the development (as opposed to deployment) environment;
#  otherwise it was unset. This has become obsolete because the zooma-apriori
#  subdirectory is now used in both development and deployment environments.

ARG dev
# ENV apdir ./${dev:+zooma-apriori/}
ENV apdir ./zooma-apriori/

#  Copy Python code and dependencies file

COPY ${apdir}/apriori_requirements.txt /home/
COPY ${apdir}/efficient_apriori_pdx.py /home/

#  Install Python dependencies and populate Solr recommender core

RUN pip3 install -r /home/apriori_requirements.txt
ENTRYPOINT [ "python3" ]
CMD [ "/home/efficient_apriori_pdx.py" ]
